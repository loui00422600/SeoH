<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
    crossorigin="anonymous"></script>
<style>
    div {}

    .main {
        width: 1500px;
        height: 1050px;
        margin: auto;
        background-color: rgb(185, 183, 183);
    }

    .main>div.head {
        height: 150px;

        display: flex;
        justify-content: space-between;
    }

    .head>div:nth-child(1) {
        width: 20%;
        height: 100%;
        display: flex;
    }

    .head>div:nth-child(1)>img {
        width: 70%;
        height: 90%;
        margin: auto;
    }

    .head>div:nth-child(3) {
        width: 25%;
        height: 100%;
    }

    .center {
        height: 900px;
    }

    .login {
        display: flex;
        justify-content: center;
        align-items: center;
        margin-right: 10px;
        flex-direction: column;

    }

    .login2 {
        display: flex;
        align-items: center;
        justify-content: center;
        margin: auto;
    }



    .login2>div:nth-child(1)>input {
        margin-bottom: 10px;
        margin-top: 10px;

        width: 200px;
    }

    .login2>div:nth-child(2) {
        margin-left: 10px;
    }


    .login2>div>button {
        width: 70px;
        height: 80px;
        border-radius: 5px;
    }

    .login2>div>button:hover {
        filter: brightness(80%);
    }

    .creat {
        display: flex;
        align-items: center;
        justify-content: center;
        margin: auto;
    }

    .creat>button:hover {
        filter: brightness(80%);
    }

    .t_modal {
        width: 1500px;
        height: 950px;
        margin: auto;
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 100;
        position: absolute;
    }

    .t_modal1 {
        width: 1500px;
        height: 950px;
        margin: auto;
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 100;
        position: absolute;

    }

    .createmodal {
        width: 30%;
        height: 70%;
        position: absolute;
        background-color: wheat;
        border-radius: 8px;
    }

    .createmodal1 {
        width: 30%;
        height: 70%;
        position: absolute;
        background-color: aquamarine;
        border-radius: 8px;

    }

    .close {
        height: 5%;
        display: flex;
        justify-content: end;
    }

    .close>img {
        height: 100%;
    }

    .user {
        height: 70%;
        text-align: center;
        display: flex;
        flex-direction: column;
        justify-content: space-evenly;

    }

    .usersub {
        justify-content: space-around;

    }

    .userbtn {
        height: 10%;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .userbtn>button {
        width: 200px;
        height: 50px;
        border-radius: 10px;
    }

    .userbtn>button:hover {
        filter: brightness(80%);
    }


    .black_wall {
        position: absolute;
        width: 100%;
        height: 1050px;
        background-color: #00000055;
    }

    .d_none {
        display: none;
    }

    #logout:hover {
        filter: brightness(80%);
    }

    #ticketing {
        margin-left: 30px;
    }

    #ticketing:hover {
        filter: brightness(80%);
    }

    @keyframes pagein {
        0% {
            opacity: 0;
        }

        100% {
            opacity: 1;

        }
    }

    .inner {
        animation: pagein 1s forwards;
    }

    .start {
        position: relative;
        display: inline-block;
    }

    .start>button {
        width: 100px;
        height: 40px;
        font-size: 15px;
        background-color: azure;
        color: black;
    }

    #drop-content {
        width: 200px;
        position: absolute;
        z-index: 1;
        height: 200px;
        display: flex;

        overflow-y: scroll;
    }

    #drop-content a {
        display: block;
        font-size: 20px;
        background-color: #dfdfdf;
        color: black;
        text-decoration: none;
        padding: 10px 36px;
        margin: 2px 0px 0px 0px;
    }

    #drop-content a:hover {
        filter: brightness(80%);
        cursor: pointer;
    }


    .end {
        position: relative;
        display: inline-block;
    }

    .end>button {
        width: 100px;
        height: 40px;
        font-size: 15px;
        background-color: azure;
        color: black;
    }

    #drop-content1 {
        width: 200px;
        position: absolute;
        z-index: 1;
        height: 200px;
        display: flex;

        overflow-y: scroll;
    }

    #drop-content1 a {
        display: block;
        font-size: 20px;
        background-color: #dfdfdf;
        color: black;
        text-decoration: none;
        padding: 10px 36px;
        margin: 2px 0px 0px 0px;
    }

    #drop-content1 a:hover {
        filter: brightness(80%);
        cursor: pointer;
    }


    .citychoice{
        display: flex;
        align-items: center;
        justify-content:space-around;
    }

    /* .backcolor{
        filter: brightness(70%);
    } */
</style>

<body>
    <!-- <div class="black_wall"></div> -->
    <div class="main">


        <div class="t_modal d_none">
            <div class="createmodal">
                <div class="close">
                    <img src="../resources/images/closebtn.webp" style="cursor: pointer;" onclick="f_onoff()" alt="">
                </div>
                <div style="text-align:center;">
                    <h1>회원가입</h1>
                </div>
                <div class="user">
                    <div class="usersub"><b>이름</b>
                        <input type="text" onchange="f_createname()" id="username"
                            style="width: 300px; border-radius: 8px;">
                        <div id="namecheck" style="font-size: 7px;"></div>
                    </div>
                    <div class="usersub"><b>id</b>
                        <input type="text" onchange="f_createid()" id="userid"
                            style="width: 300px; border-radius: 8px;">
                        <div id="idcheck" style="font-size: 7px;"></div>
                    </div>
                    <div class="usersub"><b>pw</b>
                        <input type="text" onchange="f_createpw()" id="userpw"
                            style="width: 300px; border-radius: 8px;">
                        <div id="pwcheck" style="font-size: 7px;"></div>
                    </div>
                    <div class="usersub"><b>pw확인</b>
                        <input type="text" onchange="f_createcheck()" id="userpwcheck"
                            style="width: 300px; border-radius: 8px;">
                        <div id="pwchecking" style="font-size: 7px;"></div>
                    </div>
                    <div class="usersub"><b>이메일</b>
                        <input type="text" onchange="f_createemail()" id="useremail"
                            style="width: 300px; border-radius: 8px;">
                        <div id="emailcheck" style="font-size: 7px;"></div>
                    </div>
                </div>
                <div class="userbtn">
                    <button onclick="f_join()">회원가입</button>
                </div>
            </div>
        </div>

        <div class="t_modal">
            <div style="background-color: aquamarine;" class="createmodal1">
                <div class="close">
                    <img src="../resources/images/closebtn.webp" style="cursor: pointer;" onclick="f_onoff1()" alt="">
                </div>
                <div style="text-align:center;">
                    <h2>예 매</h2>
                </div>
                <div class="ticketing">
                    <div class="citychoice" style="border: 1px solid red;">
                        <div class="start">
                            <button id="startname" onclick="f_drop()">출 발</button>
                            <div style="display: none;" id="drop-content">
                                <div>
                                    <input id='startsearch' style='width:65%' type='text'>
                                    <button onclick='f_areasearch()' style='width:30%'>검색</button>
                                </div>
                                <div id="drop-area"></div>
                            </div>
                        </div>
                        <div class="end">
                            <button id="endname" onclick="f_drop1()">도 착</button>
                            <div style="display: none;" id="drop-content1">
                                <div>
                                    <input id='endsearch' style='width:65%' type='text'>
                                    <button onclick='f_areasearch1()' style='width:30%'>검색</button>
                                </div>
                                <div id="drop-area1"></div>
                            </div>
                        </div>
                    </div>
                    <div style="width: 100%;height: 50px; border: 1px solid black;" class="traintype"></div>
                    <div style="width: 100%;height: 50px; border: 1px solid black;" class="searchbtn"></div>
                    <div style="width:100%; border: 1px solid black; height: 400px;" class="ticketingtime"></div>
                    <div></div>
                </div>
                <div class="userbtn">
                </div>
            </div>
        </div>



        <div class="head">
            <div class="logo">
                <img src="../resources/images/trainlogo-removebg-preview.png" alt="">
            </div>
            <div class="t_title" style="width: 70%;  border: 1px solid blue;"></div>
            <div class="login">
                <div class="login2">
                    <div>
                        ID&nbsp;&nbsp;<input id="loginid" type="text"><br>
                        PW<input id="loginpw" type="password">
                    </div>
                    <div>
                        <button style="font-size: 15px; font-weight: bolder;" onclick="f_login()">로그인</button>
                    </div>
                </div>
                <div class="creat">
                    <button
                        style="font-weight: bolder; background-color: cornflowerblue; border-radius:10px ; width: 200px;height: 40px;"
                        onclick="f_onoff()">회 원 가 입</button>
                </div>
                <div class="userlog d_none"></div>
            </div>
        </div>
        <div class="center backcolor">
            <div id="carouselExampleInterval" class="carousel slide" data-bs-ride="carousel">
                <div class="carousel-inner">
                    <div class="carousel-item active" data-bs-interval="10000">
                        <img src="../resources/images/trainback4.jpg" style="width:100%; height: 900px;" class=""
                            alt="...">
                    </div>
                    <div class="carousel-item" data-bs-interval="2000">
                        <img src="../resources/images/trainback2.jpg" style="width:100%;  height: 900px; z-index: 50;"
                            class="" onclick="f_onoff()" alt="...">
                    </div>
                    <div class="carousel-item">
                        <img src="../resources/images/trainback3.jpg" style="width:100%;  height: 900px;" class=""
                            alt="...">
                    </div>
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleInterval"
                    data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleInterval"
                    data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        const v_creatname = document.getElementById("username");
        const v_creatid = document.getElementById("userid");
        const v_creatpw = document.getElementById("userpw");
        const v_creatpwcheck = document.getElementById("userpwcheck");
        const v_createmail = document.getElementById("useremail");
        const v_idcheck = document.getElementById("idcheck");
        const v_pwcheck = document.getElementById("pwcheck");
        const v_namecheck = document.getElementById("namecheck");
        const v_pwchecking = document.getElementById("pwchecking");
        const v_emailcheck = document.getElementById("emailcheck");
        const v_modal1 = document.querySelector(".creatmodal");
        const v_loginid = document.querySelector("#loginid");
        const v_loginpw = document.querySelector("#loginpw");
        const v_creatbtn = document.querySelector(".creat");
        const v_login2 = document.querySelector(".login2");


        let onoff = false;
        function f_onoff() {
            if (!onoff) {
                v_modal.classList.remove("d_none");
                v_modal.classList.add("inner");
                onoff = true;
                f_reset();
            } else {
                v_modal.classList.remove("inner");
                v_modal.classList.add("d_none");
                onoff = false;
            }
        }


        function f_createname() {
            if (v_creatname.value != "") {
                v_creatname.style.boxShadow = "0px 0px 2px 2px skyblue"
                v_namecheck.style.color = "skyblue"
                v_namecheck.innerHTML = "이름이 입력되었습니다."
            } else {
                v_creatname.style.boxShadow = "0px 0px 2px 2px red"
                v_namecheck.style.color = "red"
                v_namecheck.innerHTML = "이름을 입력해주세요."
            }

        }

        function f_createid() {
            let regex = /^[a-zA-Z0-9]{6,12}$/;
            let v_result = regex.test(v_creatid.value);
            if (!v_result) {
                v_creatid.style.boxShadow = "0px 0px 2px 2px red"
                v_idcheck.style.color = "red"
                v_idcheck.innerHTML = "형식에 맞지 않는 id입니다."
            }
            else {
                v_creatid.style.boxShadow = "0px 0px 2px 2px skyblue"
                v_idcheck.style.color = "skyblue"
                v_idcheck.innerHTML = "사용가능한 id입니다."
            }
            f_sameid();

        }

        function f_createpw() {
            let regex = /^(?=.*[a-z])(?=.*[0-9])[a-zA-Z0-9~!@#$%^&*)(-=]{7,14}$/
            let v_result = regex.test(v_creatpw.value);
            if (!v_result) {
                v_creatpw.style.boxShadow = "0px 0px 2px 2px red"
                v_pwcheck.style.color = "red"
                v_pwcheck.innerHTML = "형식에 맞지 않는 password입니다."
            } else {
                v_creatpw.style.boxShadow = "0px 0px 2px 2px skyblue"
                v_pwcheck.style.color = "skyblue"
                v_pwcheck.innerHTML = "사용가능한 password입니다."
            }
        }

        function f_createcheck() {
            if (v_creatpwcheck.value != v_creatpw.value || v_pwcheck.style.color == "red") {
                v_creatpwcheck.style.boxShadow = "0px 0px 2px 2px red"
                v_pwchecking.style.color = "red"
                v_pwchecking.innerHTML = "패스워드를 다시 입력해주세요."
            } else {
                v_creatpwcheck.style.boxShadow = "0px 0px 2px 2px skyblue"
                v_pwchecking.style.color = "skyblue"
                v_pwchecking.innerHTML = "일치합니다."
            }
        }

        function f_createemail() {
            let regex = /^[a-zA-Z0-9]+[@][a-z]+[.][a-z]+$/;
            let v_result = regex.test(v_createmail.value);
            if (!v_result) {
                v_createmail.style.boxShadow = "0px 0px 2px 2px red"
                v_emailcheck.style.color = "red"
                v_emailcheck.innerHTML = "형식에 맞지 않는 email입니다."
            } else {
                v_createmail.style.boxShadow = "0px 0px 2px 2px skyblue"
                v_emailcheck.style.color = "skyblue"
                v_emailcheck.innerHTML = "사용 가능한 email입니다."
            }
            f_sameemail();
        }

        function f_join() {
            if (v_namecheck.style.color == "skyblue"
                && v_idcheck.style.color == "skyblue"
                && v_pwcheck.style.color == "skyblue"
                && v_pwchecking.style.color == "skyblue"
                && v_emailcheck.style.color == "skyblue") {

                let v_userArray;
                let v_user = {};
                if (localStorage.getItem("userDB") == null) {
                    v_userArray = [];
                } else {
                    v_userArray = JSON.parse(localStorage.getItem("userDB"));
                }

                v_user["name"] = v_creatname.value;
                v_user["id"] = v_creatid.value;
                v_user["password"] = v_creatpw.value;
                v_user["email"] = v_createmail.value;
                v_userArray.push(v_user);
                console.log(v_userArray);
                localStorage.setItem("userDB", JSON.stringify(v_userArray));
                v_modal.classList.add("d_none");
                onoff = false;
                alert("회원가입이 완료되었습니다.")
            } else {
                alert("정보가 잘못되었습니다. 다시 확인해주세요.")
            }
        }
        let v_userDB = JSON.parse(localStorage.getItem("userDB"));

        function f_sameid() {
            let v_userDB = JSON.parse(localStorage.getItem("userDB"));
            for (let i = 0; i < v_userDB.length; i++) {
                if (v_userDB[i]["id"] == v_creatid.value) {
                    v_creatid.style.boxShadow = "0px 0px 2px 2px red"
                    v_idcheck.style.color = "red"
                    v_idcheck.innerHTML = "중복되는 id입니다.";
                    break;
                }
            }
        }

        function f_sameemail() {
            let v_userDB = JSON.parse(localStorage.getItem("userDB"));
            for (let i = 0; i < v_userDB.length; i++) {
                if (v_userDB[i]["email"] == v_createmail.value) {
                    v_createmail.style.boxShadow = "0px 0px 2px 2px red"
                    v_emailcheck.style.color = "red"
                    v_emailcheck.innerHTML = "중복되는 email입니다.";
                    break;
                }
            }
        }

        function f_reset() {
            v_creatid.value = "";
            v_creatpw.value = "";
            v_creatpwcheck.value = "";
            v_createmail.value = "";
            v_creatname.value = "";
            v_creatname.style.boxShadow = ""
            v_namecheck.style.color = ""
            v_namecheck.innerHTML = ""
            v_creatid.style.boxShadow = ""
            v_idcheck.style.color = ""
            v_idcheck.innerHTML = ""
            v_creatpw.style.boxShadow = ""
            v_pwcheck.style.color = ""
            v_pwcheck.innerHTML = ""
            v_creatpwcheck.style.boxShadow = ""
            v_pwchecking.style.color = ""
            v_pwchecking.innerHTML = ""
            v_createmail.style.boxShadow = ""
            v_emailcheck.style.color = ""
            v_emailcheck.innerHTML = ""
        }


        const v_login = document.querySelector(".login");
        const v_userlog = document.querySelector(".userlog");
        let loginch = false;
        function f_login() {
            for (let i = 0; i < v_userDB.length; i++) {
                if (v_userDB[i]["id"] == v_loginid.value
                    && v_userDB[i]["password"] == v_loginpw.value) {
                    sessionStorage.setItem("LoginUser", JSON.stringify(v_userDB[i]));
                    v_creatbtn.classList.add("d_none");
                    v_login2.classList.add("d_none");
                    v_userlog.classList.remove("d_none");
                    v_userlog.innerHTML = "<div>" + v_userDB[i]["name"] + "님께서 로그인 하셨습니다.</div>";
                    v_userlog.innerHTML += "<button id='logout' onclick='f_logout()'>로그아웃</button>";
                    v_userlog.innerHTML += "<button id='ticketing' style='margin-right:30px;' onclick='f_ticketingch()'>예매현황</button>"
                    loginch = true;
                }
            }
            if (!loginch) {
                alert("다시입력해주세요.");
            }
        }

        function f_logout() {
            if (loginch) {
                loginch = false;
                // v_loginid.value="";
                // v_loginpw.value="";
                // v_userlog.innerHTML="";
                sessionStorage.removeItem("LoginUser");
                // v_userlog.classList.add("d_none");
                // v_creatbtn.classList.remove("d_none");
                // v_login2.classList.remove("d_none");
                location.reload();
            }
        }

        let v_startname = document.querySelector("#startname");
        let v_endname = document.querySelector("#endname");
        let v_drop1 = document.querySelector("#drop-content");
        let v_drop2 = document.querySelector("#drop-content1");
        let v_droparea = document.querySelector("#drop-area");
        let v_droparea1 = document.querySelector("#drop-area1");
        let v_allarea = JSON.parse(localStorage.getItem("allarea"));


        function f_drop() {
            for (let i = 0; i < v_allarea.length; i++) {
                v_droparea.innerHTML += "<a onclick='f_areaclick()'>" + v_allarea[i]["nodename"] + "</a>";
            }
            if (v_drop1.style.display === "none") {
                v_drop1.style.display = "block";
            } else {
                v_drop1.style.display = "none";
            }
        } 
        function f_drop1() {
            for (let i = 0; i < v_allarea.length; i++) {
                // let v_a = document.createElement("a");
                v_droparea1.innerHTML += "<a onclick='f_areaclick1()'>" + v_allarea[i]["nodename"] + "</a>";
                // v_drop1.appendChild(v_a)
            }
            if (v_drop2.style.display === "none") {
                v_drop2.style.display = "block";
            } else {
                v_drop2.style.display = "none";
            }
        }

        function f_areaclick() {
            v_startname.innerHTML = event.target.innerHTML;
            if (v_drop1.style.display === "none") {
                v_drop1.style.display = "block";
            } else {
                v_drop1.style.display = "none";
            }
        }
        function f_areaclick1() {
            v_endname.innerHTML = event.target.innerHTML;
            if (v_drop2.style.display === "none") {
                v_drop2.style.display = "block";
            } else {
                v_drop2.style.display = "none";
            }
        }

        let v_startsearch = document.querySelector("#startsearch");
        function f_areasearch() {
            v_droparea.innerHTML = "";
            console.log(v_startsearch.value);
            for (let i = 0; i < v_allarea.length; i++) {
                if (v_allarea[i]["nodename"].indexOf(v_startsearch.value) != -1) {
                    v_droparea.innerHTML += "<a onclick='f_areaclick()'>" + v_allarea[i]["nodename"] + "</a>";
                }
            }
        } 
        
        function f_areasearch1() {
            v_droparea.innerHTML = "";
            console.log(v_endsearch.value);
            for (let i = 0; i < v_allarea.length; i++) {
                if (v_allarea[i]["nodename"].indexOf(v_endsearch.value) != -1) {
                    v_droparea.innerHTML += "<a onclick='f_areaclick()'>" + v_allarea[i]["nodename"] + "</a>";
                }
            }
        }

        console.log(JSON.parse(localStorage.getItem("allarea")).length);
    </script>
</body>

</html>